using System;
using System.Collections.Generic;
using System.IO;

using Newtonsoft.Json;

using ParcelleLibraryJSON.Gestions;

namespace ParcelleLibraryJSON
{
    public class Exploitant
    {
        #region Attributs
        private int id;
        private string nom;
        private string prenom;
        private string telephone;

        private GestionParcelles gestion = new GestionParcelles();
        #endregion

        public int Id
        {
            get { return id; }
        }
        public string Nom
        {
            get { return nom; }
        }
        public string Prenom
        {
            get { return prenom; }
        }
        public string NomAffiche
        {
            get { return nom + " " + prenom; }
        }
        public string Telephone
        {
            get { return telephone; }
            set
            {
                if (string.IsNullOrEmpty(value))
                    telephone = "";
                else
                    telephone = value;
            }
        }

        public string Mail { get; set; }

        public List<Parcelle> Parcelles
        {
            get { return gestion.Parcelles; }
        }

        public Exploitant(int id, string nom)
        {
            this.id = id;
            this.nom = nom;
        }

        #region Gestion parcelles
        public void AjouterParcelle(Parcelle p)
        {
            p.Exploitant = this;
            gestion.Ajouter(p);
        }
        public void SupprimerParcelle(int num)
        {
            gestion.Supprimer(num);
        }
        public Parcelle ObtenirParcelle(int num)
        {
            return gestion.GetParcelle(num);
        }
        public List<Parcelle> ObtenirParcelles()
        {
            return gestion.Parcelles;
        }
        #endregion

        public void ResolveReferences()
        {
            foreach (Parcelle p in gestion.Parcelles)
            {
                p.Exploitant = this;
                p.ResolveReferences();
            }
        }

        

        /*public string Serialize()
        {
            string xml = "";
            xml += "<exploitant>";
            xml += string.Format("<id>{0}</id>", id);
            xml += string.Format("<nom>{0}</nom>", nom);
            xml += "<parcelles>";
            // Parcours des parcelles
            foreach(Parcelle p in gestion.Parcelles)
            {
                xml += p.Serialize();
            }
            xml += "</parcelles>";

            xml += "</exploitant>";
            return xml;
        }*/
    }
}
